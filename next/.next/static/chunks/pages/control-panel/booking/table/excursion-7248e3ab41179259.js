(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1650],{31368:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/control-panel/booking/table/excursion",function(){return t(81360)}])},86998:function(n,e,t){"use strict";t.d(e,{t:function(){return l}});var o=t(7297),r=t(186);function i(){let n=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: 26px;\n  width: 100%;\n"]);return i=function(){return n},n}let l=r.ZP.div.withConfig({componentId:"sc-9dddfa2c-0"})(i())},79417:function(n,e,t){"use strict";t.d(e,{Z:function(){return S}});var o=t(85893),r=t(7297),i=t(186),l=t(41664),u=t.n(l);function c(){let n=(0,r.Z)([""]);return c=function(){return n},n}function a(){let n=(0,r.Z)(["\n     align-items: center;\n  "]);return a=function(){return n},n}function s(){let n=(0,r.Z)(["\n  display: flex;\n  flex-direction: row;\n  gap: 10px;\n  list-style-type: none;\n  align-items: center;\n  flex-wrap: wrap;\n\n  ","\n"]);return s=function(){return n},n}function d(){let n=(0,r.Z)(["\n  display: flex;\n  gap: 8px;\n"]);return d=function(){return n},n}function f(){let n=(0,r.Z)(["\n      font-size: ","\n    "]);return f=function(){return n},n}function g(){let n=(0,r.Z)(["\n    color: ",";\n    font-weight: ",";\n    font-size: ",";\n    ",";\n  "]);return g=function(){return n},n}function h(){let n=(0,r.Z)(["\n  ","\n"]);return h=function(){return n},n}function m(){let n=(0,r.Z)(["\n      max-width: 34vw;\n    "]);return m=function(){return n},n}function p(){let n=(0,r.Z)(["\n      font-size: ","\n    "]);return p=function(){return n},n}function x(){let n=(0,r.Z)(["\n    color: ",";\n    font-weight: ",";\n    font-size: ",";\n    max-width: 26vw;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n\n    ","\n\n    ","\n  "]);return x=function(){return n},n}function v(){let n=(0,r.Z)(["\n  ","\n"]);return v=function(){return n},n}function w(){let n=(0,r.Z)(["\n      max-width: 34vw;\n    "]);return w=function(){return n},n}function b(){let n=(0,r.Z)(["\n      font-size: ","\n    "]);return b=function(){return n},n}function C(){let n=(0,r.Z)(["\n    max-width: 26vw;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n\n    ","\n\n    ","\n  "]);return C=function(){return n},n}function T(){let n=(0,r.Z)(["\n  ","\n"]);return T=function(){return n},n}let P=i.ZP.nav.withConfig({componentId:"sc-39019b6d-0"})(c()),y=i.ZP.ul.withConfig({componentId:"sc-39019b6d-1"})(s(),n=>{let{theme:e}=n;return e.media.down("xs")(a())}),Z=i.ZP.li.withConfig({componentId:"sc-39019b6d-2"})(d()),j=i.ZP.span.withConfig({componentId:"sc-39019b6d-3"})(h(),n=>{let{theme:e}=n;return(0,i.iv)(g(),e.colors.primary,e.font.weight,e.font.size.subtitle1,e.media.down("xs")(f(),e.font.size.body2))}),E=i.ZP.span.withConfig({componentId:"sc-39019b6d-4"})(v(),n=>{let{theme:e}=n;return(0,i.iv)(x(),e.colors.default,e.font.weight,e.font.size.subtitle1,e.media.down("md")(m()),e.media.down("xs")(p(),e.font.size.body2))}),A=(0,i.ZP)(u()).withConfig({componentId:"sc-39019b6d-5"})(T(),n=>{let{theme:e}=n;return(0,i.iv)(C(),e.media.down("md")(w()),e.media.down("xs")(b(),e.font.size.body2))});var k=t(67294),N=t(34956);let I=n=>{let{paths:e,isMobile:t}=n,r=e,i=!1;return t&&e.length>2&&(r=e.slice(-2),i=!0),(0,o.jsx)(P,{children:(0,o.jsxs)(y,{children:[i&&(0,o.jsxs)(Z,{children:[(0,o.jsx)("span",{children:"..."}),(0,o.jsx)(N.Z,{})]}),r.map((n,e)=>(0,o.jsxs)(k.Fragment,{children:[(0,o.jsx)(Z,{children:n.url&&e!==r.length-1?(0,o.jsx)(A,{href:n.url,passHref:!0,children:(0,o.jsx)(j,{children:n.label})}):(0,o.jsx)(E,{children:n.label})}),r.length-1>e&&(0,o.jsx)(Z,{children:(0,o.jsx)(N.Z,{})})]},e))]})})};var S=I},27030:function(n,e,t){"use strict";t.d(e,{Z:function(){return y}});var o=t(85893);t(67294);var r=t(7297),i=t(186);let l={WAITING_PARTNER:"WAITING_PARTNER",WAITING_PAYMENT:"WAITING_PAYMENT",PARTNER_ACCEPTED:"PARTNER_ACCEPTED",PAID:"PAID",CANCELLED:"CANCELLED"};function u(){let n=(0,r.Z)(["\n      padding: 16px;\n      border-radius: 8px;\n      border: 1px solid #1d7abd;\n    "]);return u=function(){return n},n}function c(){let n=(0,r.Z)(["\n  min-width: 120px;\n  width: max-content;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  ",";\n"]);return c=function(){return n},n}function a(){let n=(0,r.Z)(["\n  width: 7px;\n  height: 7px;\n  border-radius: 7px;\n  background-color: ",";\n"]);return a=function(){return n},n}function s(){let n=(0,r.Z)(["\n    font-family: ",";\n    font-size: ",";\n    font-weight: ",";\n    color: ",";\n  "]);return s=function(){return n},n}function d(){let n=(0,r.Z)(["\n  ",";\n  line-height: normal;\n  vertical-align: middle;\n"]);return d=function(){return n},n}function f(){let n=(0,r.Z)(["\n  width: 100px;\n  height: 34px;\n  border-radius: 16px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  background-color: ",";\n"]);return f=function(){return n},n}function g(){let n=(0,r.Z)(["\n    font-family: ",";\n    font-weight: ",";\n    color: ",";\n  "]);return g=function(){return n},n}function h(){let n=(0,r.Z)(["\n  font-size: 11px;\n  text-align: center;\n  ",";\n"]);return h=function(){return n},n}let m=(n,e)=>n===l.PAID?e?"#6fcf97":"rgb(111, 207, 151, 0.3)":n===l.CANCELLED?e?"#de3730":"rgb(222, 55, 48, 0.3)":n===l.WAITING_PAYMENT?e?"#f29200":"rgb(242, 146, 0, 0.3)":n===l.WAITING_PARTNER||n===l.PARTNER_ACCEPTED?e?"#f29200":"rgb(5, 49, 118, 0.3)":"inherit",p=i.ZP.div.withConfig({componentId:"sc-3d156085-0"})(c(),n=>{let{$bordered:e}=n;return e&&(0,i.iv)(u())}),x=i.ZP.div.withConfig({componentId:"sc-3d156085-1"})(a(),n=>{let{$status:e}=n;return m(e,!0)}),v=i.ZP.span.withConfig({componentId:"sc-3d156085-2"})(d(),n=>{let{theme:e,isTable:t}=n;return(0,i.iv)(s(),t?e.font.family.gothicBook:e.font.family.gothicMedium,e.font.size.body2,e.font.weight.regular,e.colors.default)}),w=i.ZP.div.withConfig({componentId:"sc-3d156085-3"})(f(),n=>{let{$status:e}=n;return m(e,!1)}),b=i.ZP.p.withConfig({componentId:"sc-3d156085-4"})(h(),n=>{let{theme:e,$status:t,isTable:o}=n;return(0,i.iv)(g(),e.font.family.gothicMedium,o?400:700,m(t,!0))});var C=t(40152),T=t(80514);let P=n=>{var e,t;let{status:r,bordered:i,isTable:u}=n,c=(0,C.Z)("(max-width: ".concat(T.AV.xs,"px)")),a=new Map([[l.WAITING_PARTNER,"Ожидание подтверждения"],[l.WAITING_PAYMENT,"Ожидание оплаты"],[l.PAID,"Оплачено"],[l.CANCELLED,"Отменено"],[l.PARTNER_ACCEPTED,"Подтверждено партнером"]]);return c?(0,o.jsx)(w,{$status:r,children:(0,o.jsx)(b,{$status:r,isTable:u,children:null!==(e=a.get(r))&&void 0!==e?e:"-"})}):(0,o.jsxs)(p,{$bordered:i,children:[(0,o.jsx)(x,{$status:r}),(0,o.jsx)(v,{isTable:u,children:null!==(t=a.get(r))&&void 0!==t?t:"-"})]})};var y=P},6153:function(n,e,t){"use strict";var o=t(85893);t(67294);let r=n=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...n,children:(0,o.jsx)("path",{fill:"#8DAEC1",d:"M21.188 24H8.438a2.815 2.815 0 01-2.813-2.813V8.438a2.815 2.815 0 012.813-2.812h12.75A2.815 2.815 0 0124 8.438v12.75A2.815 2.815 0 0121.187 24zM8.438 7.5a.939.939 0 00-.938.938v12.75c0 .516.42.937.938.937h12.75c.516 0 .937-.42.937-.938V8.438a.939.939 0 00-.938-.937H8.438zm-4.688 9h-.938a.939.939 0 01-.937-.938V2.813c0-.516.42-.937.938-.937h12.75c.516 0 .937.42.937.938v.89h1.875v-.89A2.815 2.815 0 0015.562 0H2.813A2.815 2.815 0 000 2.813v12.75a2.815 2.815 0 002.813 2.812h.937V16.5z"})});e.Z=r},85038:function(n,e,t){"use strict";var o=t(85893);t(67294);let r=n=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"2 2 20 20",fill:"none",...n,children:(0,o.jsx)("path",{fill:"#fff",d:"m12 18.5 4-4H8l4 4ZM16 10.5l-4-4-4 4h8Z"})});e.Z=r},34956:function(n,e,t){"use strict";var o=t(85893);t(67294);let r=n=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:10,height:20,fill:"none",...n,children:(0,o.jsx)("path",{stroke:n.stroke?n.stroke:"#222121",strokeLinecap:"round",strokeWidth:2,d:"m1 1 7.293 7.293a1 1 0 0 1 0 1.414L1 17"})});e.Z=r},95513:function(n,e,t){"use strict";t.d(e,{m:function(){return r}});var o=t(51949);let r=()=>{let n=(0,o.l)(),e=e=>{navigator.clipboard.writeText(e).then(()=>n("Вы удачно скопировали поле","success")).catch(()=>n("Что-то пошло не так, попробуйте заново","error"))};return[e]}},88025:function(n,e,t){"use strict";t.d(e,{F8:function(){return h},G9:function(){return m},HK:function(){return g},PK:function(){return d},PM:function(){return x},Qw:function(){return p},TK:function(){return c},YE:function(){return s},mQ:function(){return v},px:function(){return f}});var o=t(49836),r=t(49305);let i=r.gk.injectEndpoints({endpoints:n=>({blockPlacement:n.mutation({query:n=>({url:"/placement/".concat(n,"/block"),method:"PUT"})}),unblockPlacement:n.mutation({query:n=>({url:"/placement/".concat(n,"/unblock"),method:"PUT"})}),deletePlacement:n.mutation({query:n=>({url:"/placement/".concat(n),method:"DELETE",body:n})}),getPartnerPlacements:n.query({query:n=>({url:"/placement?".concat(n)}),transformResponse:(n,e,t)=>{var o;return{...n,totalCount:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:o.headers.get("X-TOTAL-COUNT"))||"1"}},providesTags:["Placements"],keepUnusedDataFor:0}),getBookingData:n.query({query:n=>({url:"/placement?".concat((0,o.z)(n))}),transformResponse:(n,e,t)=>{var o;return{data:n,totalCount:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:o.headers.get("X-TOTAL-COUNT"))||"1"}},keepUnusedDataFor:0}),getDetailBookingData:n.query({query:n=>{let{id:e,urlQueries:t}=n;return{url:"/placement/".concat(e,"?").concat("string"!=typeof t?(0,o.z)(t):t)}}}),getSpecialOffer:n.query({query:()=>({url:"/placement?specialOffer=true"})}),bookCurrentRoom:n.mutation({query:n=>({url:"/booking/verify",method:"POST",body:n}),extraOptions:{name:"bookCurrentRoom"}}),getBookedListItems:n.query({query:n=>({url:"/booking?".concat(n)}),transformResponse:(n,e)=>{var t;return{...n,totalCount:(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.headers.get("X-TOTAL-COUNT"))||"1"}},providesTags:["bookings"],keepUnusedDataFor:0}),getBookedExcursionGroupedItems:n.query({query:n=>({url:"/booking/excursion?".concat(n)}),transformResponse:(n,e)=>{var t;return{...n,totalCount:(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.headers.get("X-TOTAL-COUNT"))||"1"}},keepUnusedDataFor:0,providesTags:["bookings"]}),addPlacementById:n.mutation({query:n=>({url:"/placement",method:"POST",body:n}),invalidatesTags:["Placements"],extraOptions:{name:"addPlacement"}}),getBookingDataByAmenities:n.query({query:n=>({url:"/placement?".concat((0,o.z)(n))}),transformResponse:(n,e,t)=>{var o;return{data:n.data,totalCount:(null==e?void 0:null===(o=e.response)||void 0===o?void 0:o.headers.get("X-TOTAL-COUNT"))||"1",amenitiesData:n.amenitiesData}}}),addExcursionExternalPlaces:n.mutation({query:n=>({url:"/booking/excursion",method:"PUT",body:n})})}),overrideExisting:!0}),{endpoints:{getBookingData:l,getDetailBookingData:u}}=i,{useGetDetailBookingDataQuery:c,useGetSpecialOfferQuery:a,useBookCurrentRoomMutation:s,useGetBookedListItemsQuery:d,useAddPlacementByIdMutation:f,useGetPartnerPlacementsQuery:g,useDeletePlacementMutation:h,useUnblockPlacementMutation:m,useBlockPlacementMutation:p,useGetBookedExcursionGroupedItemsQuery:x,useAddExcursionExternalPlacesMutation:v,useGetBookingDataByAmenitiesQuery:w}=i},81360:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return j}});var o=t(85893),r=t(27982),i=t(67294),l=t(27060),u=t(74094),c=t(27030),a=t(15442),s=t(27484),d=t.n(s),f=t(11163),g=t(85038),h=t(78872),m=t(88025),p=t(49836),x=t(96894),v=t(86998),w=t(34443),b=t(65959),C=t(79417),T=t(6153),P=t(95513);let y=()=>{var n,e;let[t,r]=(0,i.useState)(0),[s,y]=(0,i.useState)(1),[Z,j]=(0,i.useState)([]),[E]=(0,P.m)(),A=(0,f.useRouter)(),k=[{url:"/control-panel/booking",label:"Бронирования"},{url:"/control-panel/booking?bookingActiveTab=".concat(h.UW.EXCURSION),label:"Экскурсии"},{label:"".concat(A.query.name)}],{data:N,isLoading:I,isError:S,isFetching:R}=(0,m.PK)((0,p.z)({type:h.UW.EXCURSION,limit:x.UZ,offset:t,sortBy:null===(n=Z[0])||void 0===n?void 0:n.id,orderBy:(null===(e=Z[0])||void 0===e?void 0:e.desc)?p.K.ASC:p.K.DESC,time:A.query.time||null,excursionId:A.query.id||null,dateTime:A.query.dateTime||null}),{skip:!A.query.id}),D=(0,i.useMemo)(()=>Math.ceil(Number(null==N?void 0:N.totalCount)/x.UZ),[null==N?void 0:N.totalCount]),z=n=>{r((n-1)*x.UZ),y(n)},q=(0,l.Cl)(),_=(0,i.useMemo)(()=>[q.accessor("guest",{size:657,enableSorting:!0,header:()=>"Имя туриста",cell:n=>"".concat(n.row.original.guest.firstName," ").concat(n.row.original.guest.lastName)}),q.accessor("name",{size:657,enableSorting:!1,header:()=>"Название экскурсии",cell:n=>n.getValue()}),q.accessor("eventStartDateTime",{size:200,enableSorting:!1,header:()=>"Дата - время",cell:n=>(0,o.jsx)(a.j5,{oneLine:!0,children:d()(n.row.original.eventStartDateTime).utc(!1).format("".concat(x.K_," HH:mm"))})}),q.accessor("guest.email",{size:200,id:"email",enableSorting:!0,enableHiding:!0,header:()=>"Email",cell:n=>(0,o.jsxs)(a.Ll,{children:[n.getValue(),(0,o.jsx)(T.Z,{onClick:e=>{e.stopPropagation(),E(n.getValue()||"")}})]})}),q.accessor("guest.phone",{size:200,enableHiding:!0,enableSorting:!0,id:"phone",header:()=>"Телефон",cell:n=>n.getValue()}),q.accessor("status",{size:100,enableHiding:!0,enableSorting:!0,header:()=>"Статус",cell:n=>(0,o.jsx)(c.Z,{status:n.getValue(),bordered:!1,isTable:!0})}),q.accessor("bookingNumber",{size:100,enableHiding:!0,enableSorting:!0,header:()=>"№",cell:n=>n.getValue()})],[N]),L=(0,u.b7)({data:(null==N?void 0:N.data)||[],columns:_,enableColumnResizing:!1,getCoreRowModel:(0,l.sC)(),state:{sorting:Z},onSortingChange:j,manualSorting:!0,getSortedRowModel:(0,l.tj)()}),M=n=>{A.push("/control-panel/booking/excursion/".concat(n))};return(0,o.jsxs)(v.t,{children:[(0,o.jsx)(C.Z,{paths:k}),(0,o.jsx)(a.xJ,{children:(0,o.jsxs)(a.iA,{children:[(0,o.jsx)(a.ss,{children:L.getHeaderGroups().map((n,e)=>(0,o.jsx)(a.SC,{children:n.headers.map((n,e)=>(0,o.jsx)(a.xs,{style:{width:n.column.columnDef.size},colSpan:n.colSpan,onClick:n.column.getToggleSortingHandler(),children:n.isPlaceholder?null:n.column.getCanSort()?(0,o.jsxs)(a.NF,{children:[(0,u.ie)(n.column.columnDef.header,n.getContext()),n.column.getIsSorted()?({asc:(0,o.jsx)(a.St,{}),desc:(0,o.jsx)(a.xk,{})})[n.column.getIsSorted()]:(0,o.jsx)(g.Z,{})]}):(0,u.ie)(n.column.columnDef.header,n.getContext())},"".concat(n.id,"-").concat(e)))},"".concat(n.id,"-").concat(e)))}),L.getRowModel().rows.length>0?(0,o.jsx)(a.RM,{children:L.getRowModel().rows.map((n,e)=>(0,o.jsx)(a.SC,{onClick:()=>M(n.original.id),children:n.getVisibleCells().map((n,e)=>(0,o.jsx)(a.pj,{style:{width:n.column.columnDef.size},children:(0,u.ie)(n.column.columnDef.cell,n.getContext())},"".concat(n.id,"-").concat(e)))},"".concat(n.id,"-").concat(e)))}):(0,o.jsx)(a.RM,{children:(0,o.jsx)(a.SC,{children:(0,o.jsx)(a.pj,{colSpan:8,style:{textAlign:"center"},children:"Здесь будут ваши бронирования экскурсий"})})})]})}),!R&&!I&&!S&&(null==N?void 0:N.data)&&D>1&&(0,o.jsx)(w.Z,{leftSideButtons:1,rightSideButtons:1,visiblePages:4,currentPage:s,totalPages:D,onPageChange:z,isRewindButtonsShown:!0}),(0,o.jsx)(b.Z,{showSpinner:I})]})},Z=()=>(0,o.jsx)(r.FE,{children:(0,o.jsx)(y,{})});var j=Z}},function(n){n.O(0,[8999,4881,5647,9774,2888,179],function(){return n(n.s=31368)}),_N_E=n.O()}]);