(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8701],{56008:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/control-panel/guide",function(){return n(75794)}])},31170:function(e,t,n){"use strict";n.d(t,{GD:function(){return h},Kd:function(){return p},OS:function(){return o},Zl:function(){return c},_E:function(){return g},by:function(){return a},kO:function(){return m},we:function(){return d}});var i=n(49305),r=n(49836);let l=i.gk.injectEndpoints({endpoints:e=>({deleteGuide:e.mutation({query:e=>({url:"/guide/".concat(e),method:"DELETE"})}),hideShowGuide:e.mutation({query:e=>{let{id:t,isHide:n}=e;return{url:"/guide/".concat(t),method:"PUT",body:{isHide:!n}}}}),getPartnerGuideList:e.query({query:e=>({url:"/guide?".concat(e)}),transformResponse:(e,t)=>{var n;return{...e,totalCount:(null==t?void 0:null===(n=t.response)||void 0===n?void 0:n.headers.get("X-TOTAL-COUNT"))||"1"}},providesTags:["partnerGuideList"],keepUnusedDataFor:0}),getGuideById:e.query({query:e=>{let{id:t}=e;return{url:"/guide/".concat(t),method:"GET"}},providesTags:["guide"]}),getGuideList:e.query({query:e=>({url:"/guide?".concat((0,r.z)(e))}),transformResponse:(e,t)=>{var n;return{...e,totalCount:(null==t?void 0:null===(n=t.response)||void 0===n?void 0:n.headers.get("X-TOTAL-COUNT"))||"1"}},keepUnusedDataFor:0,providesTags:["guide"]}),getGuideByIdTourist:e.query({query:e=>{let{id:t}=e;return{url:"/guide/".concat(t,"/tourist"),method:"GET"}},providesTags:["guide"]}),addGuide:e.mutation({query:e=>({url:"/guide",method:"POST",body:e}),extraOptions:{name:"createGuide"}}),updateGuide:e.mutation({query:e=>{let{data:t,id:n}=e;return{url:"/guide/".concat(n),method:"PUT",body:t}},extraOptions:{name:"updateGuide"},invalidatesTags:["partnerGuideList"]})}),overrideExisting:!0}),{endpoints:{getGuideById:s,getGuideByIdTourist:u}}=l,{useGetGuideByIdQuery:o,useGetGuideListQuery:d,useAddGuideMutation:a,useUpdateGuideMutation:c,useGetPartnerGuideListQuery:g,useDeleteGuideMutation:h,useHideShowGuideMutation:p,useGetGuideByIdTouristQuery:m}=l},75794:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var i=n(85893),r=n(27982),l=n(42143),s=n(41664),u=n.n(s),o=n(67294),d=n(27060),a=n(74094),c=n(34443),g=n(65959),h=n(51949),p=n(49836),m=n(19656),x=n(85540),f=n(80357),j=n(96894),y=n(15442),w=n(31170),v=n(6153),C=n(95513);let T=()=>{let e=(0,d.Cl)(),[t]=(0,C.m)(),[n,r]=(0,o.useState)(1),[l,s]=(0,o.useState)(0),[u,{isLoading:T}]=(0,w.GD)(),[b,{isLoading:G}]=(0,w.Kd)(),[E,S]=(0,o.useState)(!1),[_,k]=(0,o.useState)(null),z=(0,h.l)(),{data:P,isLoading:q,refetch:D,isError:O}=(0,w._E)((0,p.z)({limit:j.UZ,offset:l})),Z=e=>{k(e),S(!0)},L=()=>{k(null),S(!1)},N=async(e,t)=>{await b({id:e,isHide:t}),D()},R=async()=>{if(_)try{await u(_).unwrap(),z("Гид был удален успешно","success"),D()}catch(e){z("Гид не был удален. Попробуйте заново","error")}finally{S(!1)}},U=e=>{s((e-1)*j.UZ),r(e)},F=(0,o.useMemo)(()=>Math.ceil(Number(null==P?void 0:P.totalCount)/j.UZ),[null==P?void 0:P.totalCount]),H=(0,o.useMemo)(()=>[e.accessor("name",{size:657,header:()=>"Имя, фамилия гида",cell:e=>(0,i.jsx)(y.ZR,{children:e.getValue()})}),e.accessor("cityName",{size:130,header:()=>"Населенный пункт",cell:e=>e.getValue()}),e.accessor("phone",{size:200,enableHiding:!0,header:()=>"Телефон",cell:e=>(0,i.jsxs)(i.Fragment,{children:["+",e.getValue()]})}),e.accessor("email",{size:200,enableHiding:!0,header:()=>"Email",cell:e=>(0,i.jsxs)(y.Ll,{children:[e.getValue(),(0,i.jsx)(v.Z,{onClick:n=>{n.stopPropagation(),t(e.getValue()||"")}})]})}),e.accessor("status",{size:100,enableHiding:!0,header:()=>"Статус",cell:e=>(0,i.jsx)(x.Z,{width:e.column.columnDef.size,status:e.getValue()})}),e.accessor("id",{id:"actions",size:96,header:()=>"Действия",cell:e=>(0,i.jsx)(m.Z,{id:e.row.original.id,width:e.column.columnDef.size,isHideValue:e.row.original.isHide,editLink:"/control-panel/guide/".concat(e.row.original.id,"/edit?step=1"),onHideShowButtonClickFn:N,onDeleteClickFn:Z})})],[P]),M=(0,a.b7)({data:(null==P?void 0:P.data)||[],columns:H,enableColumnResizing:!1,getCoreRowModel:(0,d.sC)()});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(y.xJ,{children:[!q&&!O&&(0,i.jsxs)(y.iA,{children:[(0,i.jsx)(y.ss,{children:M.getHeaderGroups().map(e=>(0,i.jsx)(y.SC,{children:e.headers.map(e=>(0,i.jsx)(y.xs,{style:{width:e.column.columnDef.size},children:e.isPlaceholder?null:(0,a.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),M.getRowModel().rows.length&&!q?(0,i.jsx)(y.RM,{children:M.getRowModel().rows.map(e=>(0,i.jsx)(y.SC,{children:e.getVisibleCells().map(e=>(0,i.jsx)(y.pj,{style:{width:e.column.columnDef.size},children:(0,a.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))}):(0,i.jsx)(y.RM,{children:(0,i.jsx)(y.SC,{children:(0,i.jsx)(y.pj,{colSpan:6,style:{textAlign:"center"},children:"Здесь будут ваши гиды"})})})]}),P&&F>1&&(0,i.jsx)(c.Z,{leftSideButtons:1,rightSideButtons:1,visiblePages:4,currentPage:n,totalPages:F,onPageChange:U})]}),E&&(0,i.jsx)(f.p,{deletingText:"Вы уверены, что хотите удалить гида?",deletePlacementFn:R,closeButtonFn:L}),(0,i.jsx)(g.Z,{showSpinner:T||G})]})};var b=n(79417);let G=[{label:"Панель управления",url:"/control-panel"},{label:"Досуг"},{label:"Гиды"}],E=()=>(0,i.jsxs)(r.yr,{children:[(0,i.jsxs)(r.vO,{children:[(0,i.jsx)(b.Z,{paths:G}),(0,i.jsx)(u(),{href:"/control-panel/guide/add?step=1",children:(0,i.jsx)(l.Z,{dark:!0,children:"Добавить Гида"})})]}),(0,i.jsx)(T,{})]});var S=E}},function(e){e.O(0,[8999,9246,5647,1465,9774,2888,179],function(){return e(e.s=56008)}),_N_E=e.O()}]);